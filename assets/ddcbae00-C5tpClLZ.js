import{_ as P}from"./aa7442af-9y-PcNP7.js";import{tableFilterOperatorMap as N}from"./afec2121-C9tEEv6l.js";import{gx as L,F as d,gy as z,eU as C,iu as y,dw as b,it as O,c2 as H,du as F,iv as q,as as B,d as $,iw as K}from"./index-CyMr76_m.js";import{newPrimaryColumn as G,ColumnComp as v}from"./bdca90af-Ey2_L0tV.js";import"./7a2fe5b9-_-VMc9tG.js";import"./119198d1-DOPTi23L.js";import"./0a6b3cae-DX_83YlB.js";import"./bbcd8d34-UQLMzqWl.js";import"./73e0b0c0-cg4qSQqq.js";import"./3edfe717-MHa75G-T.js";import"./58f3786f-CAidjqLe.js";import"./a0462e8b-DZIRdcE2.js";import"./3b4688fc-D_wIQU04.js";import"./2606e654-BU0arLul.js";import"./779f3b7b-amEsk8BD.js";import"./6273459c-DX34gMfV.js";import"./b6a2fc32-DwuV3HZx.js";import"./1cf690a1-I_QK1KnU.js";import"./78fe38f6-CDiAuiLE.js";import"./019144c6-D7yg04yX.js";import"./4a5e4036-B1Vv5Fk3.js";import"./528263cd-C4IHPG-V.js";import"./c9e82af5-CWpE2eMW.js";import"./a88cf471-CYUSef1b.js";import"./09457722-DqGlVZ8K.js";import"./0939bf73-t5w-dpUI.js";import"./c5075bb1-DugznTE7.js";import"./a5d57101-D6143Rva.js";import"./874205af-IDtItRsf.js";import"./3b333d0b-CW89wYop.js";import"./3806f8cf-BO9BPaTR.js";import"./cb943b07-CQ1qmLm2.js";import"./0e89e2a5-BZIvfWTd.js";import"./ad1328d1-BWLAZt-j.js";const X=F(v);function _(o){if(o.length<=0||typeof o[0]=="string")return;const t={};return o.slice(0,50).forEach(e=>{Object.keys(e).forEach(r=>{t.hasOwnProperty(r)||(t[r]=e[r])})}),t}class Y extends X{reduce(t){if(L(t,"dataChanged")){const e=t.value.rowExample,{readOnly:r}=q();let a=this;if(t.value.doGeneColumn&&(t.value.dynamicColumn||!r)){const n=this.geneColumnsAction(e,t.value.data);a=this.reduce(this.multiAction(n))}return a}return super.reduce(t)}getChangeSet(){const t={};return this.getView().forEach(e=>{const r=e.getChangeSet();Object.keys(r).forEach(a=>{Object.keys(r[a]).forEach(n=>{d.isNil(r[a][n])||(t[n]||(t[n]={}),t[n][a]=r[a][n])})})}),t}dispatchClearChangeSet(){this.getView().forEach(t=>t.dispatchClearChangeSet())}dataChangedAction(t){return z({type:"dataChanged",...t},!1)}geneColumnsAction(t,e){if(t==null)return[];const r=Object.keys(t);if(r.length===0)return[];const a=this.getView(),n=[];let s=0;return a.forEach((l,u)=>{if(l.getView().isCustom)return;const p=l.getView().dataIndex;(p===m||!r.find(h=>p===h))&&(n.push(this.deleteAction(u-s)),s+=1)}),r.forEach(l=>{l===m&&M(e)||a.find(u=>u.getView().dataIndex===l)||n.push(this.pushAction(G(l,R(l,e))))}),n.length===0?[]:n}withParamsNode(){const t=this.getView(),e=d(t).map(r=>r.children.render.getOriginalComp().node()).toPairs().fromPairs().value();return C(this,"withParamsNode",[b(e),e],(r,a)=>y(r[1],a[1]))[0]}getColumnsNode(t){const e=this.getView(),r=d(e).map(a=>a.children[t].node()).toPairs().fromPairs().value();return C(this,"col_nodes_"+t,[b(r),r],(a,n)=>y(a[1],n[1]))[0]}setSelectionAction(t){return this.forEachAction(v.setSelectionAction(t))}}const Lt=Object.freeze(Object.defineProperty({__proto__:null,ColumnListComp:Y,tableDataRowExample:_},Symbol.toStringTag,{value:"Module"})),m="children",c="__ob_origin_index",U="__ob_origin_record",x=55,I=500;function Z(o,t,e,r){let a=o;return t&&(a=a.filter(n=>{let s=t==null?void 0:t.toLowerCase();return s?Object.values(n).find(l=>l==null?void 0:l.toString().toLowerCase().includes(s)):!0})),r&&e.filters.length>0&&(a=a.filter(n=>{for(let s of e.filters){const l=n[s.columnKey],u=N[s.operator].filter(s.filterValue,l);if(e.stackType==="or"&&u)return!0;if(e.stackType==="and"&&!u)return!1}return e.filters.length===0||e.stackType==="and"?!0:e.stackType!=="or"})),a}function J(o,t,e){let r=o.map((a,n)=>({...a,[c]:n+""}));if(e.length>0){const[a,n]=d(e).filter(s=>{var l;return!!s.column&&((l=t[s.column])==null?void 0:l.sortable)}).map(s=>[s.column,s.desc?"desc":"asc"]).unzip().value();r=d.orderBy(r,a.map(s=>l=>{const u=l[s];return typeof u=="string"?u.toLowerCase():u}),n)}return r}function S({hide:o,tempHide:t,enableColumnSetting:e}){return e&&t||o}function A(o,t){return o+"-"+t}function T(o,t){const e=t+"";return Array.isArray(o[m])?{...o,[c]:e,children:o[m].map((r,a)=>T(r,A(e,a+"")))}:{...o,[c]:e}}function E(o,t,e){return o.map((r,a)=>{const n={[c]:r[c]};return e.forEach(s=>{const l=s.render.wrap({currentCell:r[s.dataIndex],currentRow:d.omit(r,c),currentIndex:a%t,currentOriginalIndex:r[c]});Array.isArray(r[m])&&(n[m]=E(r[m],t,e));const u=l.comp[P](l.comp);u!==null&&(n[s.dataIndex]=u)}),n})}function k(o,t){return o.map(e=>{const r=d(e).omit(c).mapKeys((a,n)=>t[n]||n).value();return Array.isArray(e[m])?{...r,[m]:k(e[m],t)}:r})}function Q(o,t){return d.mapValues(t,(e,r)=>{const a=e.wrap().compType,n={compType:a};return a==="tag"?n.uniqueTags=d(o).map(s=>s[r]).filter(s=>!!s).uniq().value():a==="badgeStatus"&&(n.uniqueStatus=d(o).map(s=>{const l=s[r];return l.split(" ")[1]?{status:l.slice(0,l.indexOf(" ")),text:l.slice(l.indexOf(" ")+1)}:{status:l,text:""}}).uniqBy("text").value()),n})}function tt(o){const{title:t,editable:e}=o;return B("div",{children:[t,e&&$(K,{style:{verticalAlign:"baseline",marginLeft:"4px"}})]})}function et(o,t){let e=[];return Object.keys(o).forEach(r=>{t.includes(r)||e.push({label:r,value:`{{currentRow.${r}}}`})}),e.push({label:"Select with handlebars",value:"{{currentCell}}"}),e}function rt(o,t,e,r,a,n,s,l){const u=o.filter(i=>i.isCustom).map(i=>i.dataIndex),p=et(s,u),h=new Map(t.map(i=>[i.column,i.desc?"descend":"ascend"]));return d.sortBy(o,i=>{if(i.fixed==="left")return-1;if(i.fixed==="right")return Number.MAX_SAFE_INTEGER;if(n.length>0){const f=n.indexOf(i.isCustom?i.title:i.dataIndex);if(f>=0)return f}return 0}).flatMap(i=>{if(S({hide:i.hide,tempHide:i.tempHide,enableColumnSetting:e}))return[];if(a&&n.length>0&&!n.includes(i.isCustom?i.title:i.dataIndex))return[];const f=(s[i.dataIndex]??{}).uniqueTags??[],W=(s[i.dataIndex]??{}).uniqueStatus??[],V=tt({title:i.title,editable:i.editable});return{title:i.showTitle?V:"",titleText:i.title,dataIndex:i.dataIndex,align:i.align,width:i.autoWidth==="auto"?0:i.width,fixed:i.fixed==="close"?!1:i.fixed,style:{background:i.background,margin:i.margin,text:i.text,border:i.border,radius:i.radius,textSize:i.textSize,textWeight:i.textWeight,fontStyle:i.fontStyle,fontFamily:i.fontFamily,borderWidth:i.borderWidth},linkStyle:{text:i.linkColor,hoverText:i.linkHoverColor,activeText:i.linkActiveColor},cellColorFn:i.cellColor,onWidthResize:i.onWidthResize,render:(j,g,D)=>i.render({currentCell:j,currentRow:d.omit(g,c),currentIndex:D,currentOriginalIndex:O(g[c]),initialColumns:p},String(g[c])).getView().view({editable:i.editable,size:r,candidateTags:f,candidateStatus:W,textOverflow:i.textOverflow,onTableEvent:l}),...i.sortable?{sorter:!0,sortOrder:h.get(i.dataIndex)}:{}}})}function w(o){var t;return(t=o.column)!=null&&t.dataIndex?{column:o.column.dataIndex.toString(),desc:o.order==="descend"}:null}function it(o,t,e,r,a,n){if(r.action==="sort"){let s=[];if(Array.isArray(e))e.forEach(l=>{const u=w(l);u&&s.push(u)});else{const l=w(e);l&&s.push(l)}a(H("sort",s,!0)),n("sortChange")}}function R(o,t){const e=n=>{const s=new Blob([n]).size;return n.length===s?n.length*10:n.length*20},r=d.max(t.map(n=>{const s=n[o];return s?e(s.toString()):x}))||0,a=e(o);return Math.max(Math.min(I,Math.max(a,r)+10),x)}function nt(o,t){const e=o.findIndex(a=>a[c]===t);if(e<0)return;const r=o[e];return{currentRow:d.omit(r,c),currentIndex:e,currentOriginalIndex:O(r[c])}}function M(o){const t=_(o);return t&&Array.isArray(t[m])}const zt=Object.freeze(Object.defineProperty({__proto__:null,COLUMN_CHILDREN_KEY:m,COL_MAX_WIDTH:I,COL_MIN_WIDTH:x,OB_ROW_ORI_INDEX:c,OB_ROW_RECORD:U,buildOriginIndex:A,calcColumnWidth:R,columnHide:S,columnsToAntdFormat:rt,filterData:Z,genSelectionParams:nt,getColumnsAggr:Q,getOriDisplayData:E,onTableChange:it,sortData:J,supportChildrenTree:M,tranToTableRecord:T,transformDispalyData:k},Symbol.toStringTag,{value:"Module"}));export{m as C,c as O,T as a,E as b,Q as c,S as d,k as e,Z as f,nt as g,rt as h,M as i,x as j,Y as k,R as l,Lt as m,zt as n,it as o,J as s,_ as t};
